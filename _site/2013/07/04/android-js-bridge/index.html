<!DOCTYPE html>
<html lang="en">

  <head>
  <meta charset="UTF-8">
  <link href="http://gmpg.org/xfn/11" rel="profile">
  <link rel="stylesheet" href="//maxcdn.bootstrapcdn.com/font-awesome/4.3.0/css/font-awesome.min.css">

  <!-- Enable responsiveness on mobile devices-->
  <meta name="viewport" content="width=device-width, initial-scale=1.0">

  <title>
    
      Week 2.5 - androidJsBridge. &middot; Shivam Verma
    
  </title>

  <!-- CSS -->
  <link rel="stylesheet" href="/styles.css">

  <!-- Icons -->
  <link rel="apple-touch-icon-precomposed" sizes="144x144" href="/public/apple-touch-icon-precomposed.png">
  <link rel="shortcut icon" href="/public/favicon.ico">

  <!-- RSS -->
  <link rel="alternate" type="application/atom+xml" title="Shivam Verma" href="/atom.xml">
</head>

  <script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-68715317-1', 'auto');
  ga('send', 'pageview');

</script>
  <body>

    <div class="container content">
      <header class="masthead">
        <center>
          <h2 class="masthead-title">
            <a href="http://localhost:4000">Shivam Verma</a>
            <br/>
            
              &nbsp;&nbsp;&nbsp;
             <small> <a href="/index.html">Blog</a> </small>
            
              &nbsp;&nbsp;&nbsp;
             <small> <a href="/portfolio">Portfolio</a> </small>
            
              &nbsp;&nbsp;&nbsp;
             <small> <a href="/about">About</a> </small>
            
              &nbsp;&nbsp;&nbsp;
             <small> <a href="/atom.xml">Feed</a> </small>
            
          </h3>
        </center>

      </header>

      <main>
        <article class="post">
  <h1 class="post-title">Week 2.5 - androidJsBridge.</h1>
  <time datetime="2013-07-04T00:00:00+08:00" class="post-date">04 Jul 2013</time>
  <p>Its been almost two and a half weeks since the GSoC coding period started and it has been nothing less than interesting. Finally, after quite a few hours of coding I’ve been able to successfully integrate the <a href="https://github.com/vshivam/privly-applications/tree/posting-applications">Posting-Applications</a>, PlainPost and Zerobin, with the Privly Android Application.</p>

<p>The Posting applications being in Javascript created a really interesting problem of integration with the Native Android Code. Something I had never really worked with before.  The solution was however pretty simple. A Js interface is added to the WebView which enables the Js to talk to Java and then depending on the user selection, the Js code for either of the Posting Applications is loaded in the WebView.</p>

<div class="highlight"><pre><code class="language-java" data-lang="java"><span class="n">WebView</span> <span class="n">w</span> <span class="o">=</span> <span class="o">(</span><span class="n">WebView</span><span class="o">)</span><span class="n">findViewById</span><span class="o">(</span><span class="n">R</span><span class="o">.</span><span class="na">id</span><span class="o">.</span><span class="na">webview_1</span><span class="o">);</span>
<span class="n">w</span><span class="o">.</span><span class="na">getSettings</span><span class="o">().</span><span class="na">setJavaScriptEnabled</span><span class="o">(</span><span class="kc">true</span><span class="o">);</span>
<span class="n">w</span><span class="o">.</span><span class="na">addJavascriptInterface</span><span class="o">(</span><span class="k">new</span> <span class="nf">JsObject</span><span class="o">(</span><span class="k">this</span><span class="o">),</span> <span class="s">&quot;androidJsBridge&quot;</span><span class="o">);</span></code></pre></div>

<p>The <code>JsObject Class</code> defines the functions that are accessible to Js.</p>

<p>Like,</p>

<div class="highlight"><pre><code class="language-java" data-lang="java"><span class="kd">public</span> <span class="kd">class</span> <span class="nc">JsObject</span><span class="o">{</span>

    <span class="n">Context</span> <span class="n">c</span><span class="o">;</span>

    <span class="n">JsObject</span><span class="o">(</span><span class="n">Context</span> <span class="n">callingContext</span><span class="o">){</span>
        <span class="n">c</span> <span class="o">=</span> <span class="n">callingContext</span><span class="o">;</span>
    <span class="o">}</span>

    <span class="nd">@JavascriptInterface</span>
    <span class="kd">public</span> <span class="n">String</span> <span class="nf">getDeviceVersion</span><span class="o">(){</span>
        <span class="n">String</span> <span class="n">deviceVersion</span><span class="o">=</span> <span class="n">Build</span><span class="o">.</span><span class="na">VERSION</span><span class="o">.</span><span class="na">RELEASE</span><span class="o">;</span>
        <span class="n">Log</span><span class="o">.</span><span class="na">d</span><span class="o">(</span><span class="s">&quot;androidJSBridge Version Request&quot;</span><span class="o">,</span><span class="n">deviceVersion</span><span class="o">);</span>
        <span class="k">return</span> <span class="n">deviceVersion</span><span class="o">;</span>
    <span class="o">}</span>
<span class="o">}</span></code></pre></div>

<p>And the Js Code of the Posting-Applications can access these functions by using the androidJsBridge.
For example -</p>

<div class="highlight"><pre><code class="language-js" data-lang="js"><span class="kd">var</span> <span class="nx">android_version</span> <span class="o">=</span> <span class="nx">androidJsBridge</span><span class="p">.</span><span class="nx">getDeviceVersion</span><span class="p">();</span></code></pre></div>

<p>I also pushed some Android specific Js code to the Posting-Applications branch and now, the Android Application is now able to generate PlainPost and ZeroBin Links and allows the user to share the new Privly Urls.</p>

<p>Latest Code for the Android App – <a href="https://github.com/vshivam/privly-android">https://github.com/vshivam/privly-android</a></p>

</article>


<aside class="related">
  <h2>Related Posts</h2>
  <ul class="related-posts">
    
      <li>
        <h3>
          <a href="/2015/06/09/compatible-rsa-encryption/">
            Android, JavaScript and Python compatible RSA Encryption.
            <small><time datetime="2015-06-09T00:00:00+08:00">09 Jun 2015</time></small>
          </a>
        </h3>
      </li>
    
      <li>
        <h3>
          <a href="/2015/06/07/dynamic-jquery-swatch/">
            Dynamically change jQuery Mobile colour swatch.
            <small><time datetime="2015-06-07T00:00:00+08:00">07 Jun 2015</time></small>
          </a>
        </h3>
      </li>
    
      <li>
        <h3>
          <a href="/2015/02/17/dnssd-python/">
            Multicast DNS Service discovery in python.
            <small><time datetime="2015-02-17T00:00:00+08:00">17 Feb 2015</time></small>
          </a>
        </h3>
      </li>
    
  </ul>
</aside>


        
<!-- Add Disqus comments. -->
<div id="disqus_thread"></div>
<script type="text/javascript">
    /* * * CONFIGURATION VARIABLES * * */
    var disqus_shortname = 'vshivam';
    
    /* * * DON'T EDIT BELOW THIS LINE * * */
    (function() {
        var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
        dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    })();
</script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript" rel="nofollow">comments powered by Disqus.</a></noscript>
<a href="http://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>

      </main>

      <footer class="footer">
      <center> 
            <small>
              Made By Shivam Verma. <br/>Powered by Jekyll and 
              Github. Theme adapted from Poole.
            </small>
      </center>
          <!--
          &copy; 
          <time datetime="2015-12-06T15:20:38+08:00">2015</time>. All rights reserved.
          -->
        </small>
      </footer>
    </div>



  </body>
</html>
